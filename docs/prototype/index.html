<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>ã‚«ãƒãƒŸã‚¨ãƒ« - KaneMiel</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400&family=Noto+Sans+JP:wght@400;500;600;700;800;900&family=DM+Sans:ital,wght@0,400;0,500;0,600;0,700;0,800;1,400&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{
  --gold:#c9a84c;--gold-light:#e8d48b;--gold-dark:#9a7b2e;
  --navy:#0c1929;--navy-mid:#162544;--navy-light:#1e3355;
  --green:#22b573;--green-bg:#edfcf4;--green-light:#a7f0c9;
  --yellow:#e5a117;--yellow-bg:#fef8e7;--yellow-light:#fde68a;
  --red:#e04343;--red-bg:#fef0f0;--red-light:#fca5a5;
  --bg:#f4f6fa;--card:#fff;--text:#0f172a;--sub:#6b7a90;--border:#e4e9f1;
  --blue:#3366cc;--blue-bg:#eef3fc;
  --radius:14px;
  --shadow:0 1px 4px rgba(12,25,41,0.06);
  --shadow-md:0 4px 16px rgba(12,25,41,0.1);
}
html{font-size:15px}
body{
  font-family:'Noto Sans JP','DM Sans',sans-serif;
  background:var(--bg);color:var(--text);
  max-width:430px;margin:0 auto;min-height:100vh;
  -webkit-font-smoothing:antialiased;position:relative;overflow-x:hidden;
}

/* ===== BRAND LOGO ===== */
.logo-mark{display:inline-flex;align-items:center;gap:8px}
.logo-icon{position:relative;width:32px;height:32px}
.logo-icon svg{width:100%;height:100%}
.logo-text{display:flex;flex-direction:column;line-height:1}
.logo-jp{font-size:16px;font-weight:800;letter-spacing:0.04em;color:#fff}
.logo-en{font-family:'Cormorant Garamond',serif;font-size:10px;font-weight:600;letter-spacing:0.16em;color:var(--gold);text-transform:uppercase;margin-top:1px}

/* ===== ROLE BAR ===== */
.role-bar{
  background:#080e18;color:#6b7a90;
  display:flex;align-items:center;justify-content:center;
  gap:6px;padding:5px 16px;font-size:10px;font-weight:500;
}
.role-bar span{color:#e2e8f0;font-weight:700}
.role-switch{
  background:rgba(201,168,76,0.15);border:1px solid rgba(201,168,76,0.3);
  color:var(--gold);padding:2px 10px;border-radius:20px;font-size:9px;
  cursor:pointer;font-family:inherit;font-weight:700;margin-left:6px;
  transition:all .2s;letter-spacing:0.04em;
}
.role-switch:hover{background:rgba(201,168,76,0.25)}

/* ===== HEADER ===== */
.header{
  background:linear-gradient(135deg,var(--navy) 0%,var(--navy-mid) 60%,var(--navy-light) 100%);
  color:#fff;padding:12px 18px;
  display:flex;justify-content:space-between;align-items:center;
  position:sticky;top:0;z-index:100;
  border-bottom:1px solid rgba(201,168,76,0.15);
}
.header-right{display:flex;gap:8px;align-items:center}
.h-icon{
  width:34px;height:34px;border-radius:50%;
  background:rgba(201,168,76,0.1);border:1px solid rgba(201,168,76,0.2);
  display:flex;align-items:center;justify-content:center;cursor:pointer;
  font-size:15px;position:relative;transition:all .2s;
}
.h-icon:hover{background:rgba(201,168,76,0.2)}
.badge{
  position:absolute;top:-3px;right:-3px;
  background:var(--red);color:#fff;font-size:8px;
  min-width:15px;height:15px;border-radius:8px;
  display:flex;align-items:center;justify-content:center;
  font-weight:800;padding:0 3px;border:1.5px solid var(--navy);
}

/* ===== CONTENT ===== */
.content{padding:14px 14px 88px}

/* ===== CARDS ===== */
.card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);margin-bottom:10px}
.card-pad{padding:16px}

/* ===== BALANCE ===== */
.balance{
  background:linear-gradient(145deg,#0c1929 0%,#152440 40%,#1a3058 70%,#1e3966 100%);
  border-radius:18px;padding:22px 22px 20px;color:#fff;margin-bottom:12px;
  box-shadow:0 8px 32px rgba(12,25,41,0.4);position:relative;overflow:hidden;
  border:1px solid rgba(201,168,76,0.12);
}
.balance::before{
  content:'';position:absolute;top:-60px;right:-30px;
  width:160px;height:160px;
  background:radial-gradient(circle,rgba(201,168,76,0.08) 0%,transparent 70%);
}
.balance::after{
  content:'';position:absolute;bottom:-40px;left:-20px;
  width:120px;height:120px;
  background:radial-gradient(circle,rgba(201,168,76,0.05) 0%,transparent 70%);
}
.balance-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:2px;position:relative;z-index:1}
.balance-label{font-size:11px;color:rgba(255,255,255,.6);font-weight:500;letter-spacing:0.03em}
.balance-badge{font-size:9px;color:var(--gold);background:rgba(201,168,76,0.12);padding:2px 8px;border-radius:10px;font-weight:600;border:1px solid rgba(201,168,76,0.2)}
.balance-num{font-size:40px;font-weight:900;letter-spacing:-2px;font-family:'DM Sans','Noto Sans JP',sans-serif;position:relative;z-index:1}
.balance-num small{font-size:16px;font-weight:400;letter-spacing:0;margin-left:2px}
.balance-sub{font-size:10px;color:rgba(255,255,255,.4);position:relative;z-index:1;margin-top:2px}
.balance-wing{position:absolute;right:16px;top:50%;transform:translateY(-50%);opacity:.04;font-size:100px}

/* ===== SIGNAL ROW ===== */
.signals{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:12px}
.sig{
  background:var(--card);border-radius:12px;padding:13px 6px;
  text-align:center;box-shadow:var(--shadow);cursor:pointer;
  transition:all .15s;border:2px solid transparent;
}
.sig.on{border-color:var(--gold);background:linear-gradient(135deg,#fefaf0,#fff)}
.sig:active{transform:scale(.97)}
.sig-label{font-size:10px;color:var(--sub);font-weight:600;margin-bottom:5px;letter-spacing:0.03em}
.sig-icon{font-size:26px;margin-bottom:3px}
.sig-val{font-size:14px;font-weight:800;font-family:'DM Sans',sans-serif}
.sig-val.g{color:var(--green)}.sig-val.y{color:var(--yellow)}.sig-val.r{color:var(--red)}

/* ===== CHART ===== */
.chart-title{font-size:12px;font-weight:700;margin-bottom:12px;display:flex;align-items:center;gap:6px;color:var(--text)}
svg text{font-family:'DM Sans','Noto Sans JP',sans-serif}
.gridline{stroke:#f0f2f6;stroke-width:1}
.ylab{font-size:8px;fill:var(--sub);font-weight:500}
.xlab{font-size:8px;fill:var(--sub);font-weight:500}
.main-line{fill:none;stroke:var(--gold);stroke-width:2.5;stroke-linecap:round;stroke-linejoin:round}
.main-area{fill:url(#aGrad);opacity:.1}
.dline{stroke:var(--red);stroke-dasharray:5 3;stroke-width:1.5;opacity:.4}
.dot{fill:var(--gold)}.dot-r{fill:var(--red)}
.dlabel{font-size:7px;fill:var(--red);font-weight:700}
.vlabel{font-size:8px;fill:var(--gold-dark);font-weight:700}
.chart-legend{display:flex;gap:14px;justify-content:center;margin-top:10px}
.leg{display:flex;align-items:center;gap:4px;font-size:9px;color:var(--sub);font-weight:500}
.leg i{width:7px;height:7px;border-radius:50%;display:inline-block}

/* ===== SECTION TITLE ===== */
.sec-title{
  font-size:13px;font-weight:700;margin:16px 0 8px;
  display:flex;align-items:center;gap:6px;
}

/* ===== ALERTS ===== */
.alert{
  background:var(--card);border-radius:11px;padding:12px 13px;
  margin-bottom:7px;box-shadow:var(--shadow);
  display:flex;align-items:center;gap:10px;cursor:pointer;
  border-left:3px solid;transition:background .15s;
}
.alert:active{background:#fafbfc}
.alert.al-r{border-left-color:var(--red)}.alert.al-y{border-left-color:var(--yellow)}
.alert .ic{font-size:18px;flex-shrink:0}
.alert .body{flex:1}
.alert .ttl{font-size:11px;font-weight:700;margin-bottom:1px}
.alert .desc{font-size:9px;color:var(--sub)}
.alert .arr{color:var(--sub);font-size:13px;font-weight:600}

/* ===== PROJECT LIST ===== */
.proj{
  background:var(--card);border-radius:11px;padding:13px 14px;
  margin-bottom:7px;box-shadow:var(--shadow);cursor:pointer;transition:background .15s;
}
.proj:active{background:#fafbfc}
.proj-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:7px}
.proj-name{font-size:12px;font-weight:700;display:flex;align-items:center;gap:6px}
.ds{width:8px;height:8px;border-radius:50%;display:inline-block;flex-shrink:0}
.ds.g{background:var(--green)}.ds.y{background:var(--yellow)}.ds.r{background:var(--red)}
.proj-amt{font-size:14px;font-weight:800;font-family:'DM Sans',sans-serif}
.proj-bar{height:5px;background:#edf0f5;border-radius:3px;overflow:hidden;margin-bottom:5px}
.proj-fill{height:100%;border-radius:3px;transition:width .6s}
.proj-fill.g{background:linear-gradient(90deg,var(--green),#4ade80)}
.proj-fill.y{background:linear-gradient(90deg,var(--yellow),#facc15)}
.proj-fill.r{background:linear-gradient(90deg,var(--red),#f87171)}
.proj-meta{display:flex;justify-content:space-between;font-size:9px;color:var(--sub)}

/* ===== APPROVAL ===== */
.appr-summary{background:rgba(201,168,76,0.08);border:1px solid rgba(201,168,76,0.2);border-radius:10px;padding:10px 13px;margin-bottom:12px;font-size:11px;color:var(--gold-dark);font-weight:600}
.appr{
  background:var(--card);border-radius:var(--radius);padding:16px;
  margin-bottom:10px;box-shadow:var(--shadow-md);border:1px solid var(--border);
}
.appr-head{display:flex;justify-content:space-between;align-items:start;margin-bottom:10px}
.appr-proj{font-size:10px;color:var(--sub);margin-bottom:2px}
.appr-target{font-size:14px;font-weight:700}
.appr-big{font-size:24px;font-weight:900;font-family:'DM Sans',sans-serif}
.appr-big small{font-size:12px;font-weight:400}
.appr-meta{background:#f8f9fc;border-radius:10px;padding:10px 12px;margin-bottom:10px}
.appr-row{display:flex;justify-content:space-between;font-size:10px;padding:2px 0}
.appr-row .l{color:var(--sub)}
.appr-impact{border-radius:10px;padding:10px 12px;margin-bottom:12px;border:1px solid}
.appr-impact.safe{background:var(--green-bg);border-color:var(--green-light)}
.appr-impact.warn{background:var(--yellow-bg);border-color:var(--yellow-light)}
.appr-impact-t{font-size:10px;font-weight:700;margin-bottom:3px}
.appr-impact.safe .appr-impact-t{color:var(--green)}
.appr-impact.warn .appr-impact-t{color:var(--yellow)}
.appr-btns{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.btn{
  padding:12px;border:none;border-radius:11px;
  font-size:13px;font-weight:700;cursor:pointer;
  display:flex;align-items:center;justify-content:center;gap:5px;
  transition:all .15s;font-family:inherit;
}
.btn:active{transform:scale(.97)}
.btn-ok{background:var(--navy);color:var(--gold)}
.btn-ng{background:var(--red-bg);color:var(--red)}

/* ===== REPORT ===== */
.report-tabs{display:flex;background:#e8ecf2;border-radius:10px;padding:3px;margin-bottom:12px}
.rtab{
  flex:1;padding:7px;text-align:center;border-radius:8px;
  font-size:11px;font-weight:600;cursor:pointer;color:var(--sub);transition:all .2s;
}
.rtab.on{background:#fff;color:var(--text);box-shadow:0 1px 3px rgba(0,0,0,0.06)}
.kpi-row{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:12px}
.kpi{background:var(--card);border-radius:12px;padding:13px;box-shadow:var(--shadow);text-align:center}
.kpi-label{font-size:9px;color:var(--sub);font-weight:600;margin-bottom:3px;letter-spacing:0.02em}
.kpi-val{font-size:22px;font-weight:900;font-family:'DM Sans',sans-serif}
.kpi-sub{font-size:9px;margin-top:1px;font-weight:600}
.report-table{width:100%;border-collapse:collapse;font-size:11px}
.report-table th{background:#f8f9fc;padding:8px 6px;text-align:left;font-weight:600;color:var(--sub);font-size:9px;border-bottom:2px solid var(--border)}
.report-table td{padding:8px 6px;border-bottom:1px solid var(--border);vertical-align:middle}
.report-table .num{text-align:right;font-family:'DM Sans',sans-serif;font-weight:600}
.report-table .total-row{background:#f8f9fc;font-weight:700}

/* ===== INPUT ===== */
.input-type-toggle{display:flex;background:#e8ecf2;border-radius:12px;padding:3px;margin-bottom:16px}
.itt{
  flex:1;padding:10px;text-align:center;border-radius:10px;
  font-size:12px;font-weight:700;cursor:pointer;color:var(--sub);
  transition:all .2s;display:flex;align-items:center;justify-content:center;gap:5px;
}
.itt.on{background:#fff;color:var(--text);box-shadow:0 2px 6px rgba(0,0,0,0.06)}
.form-group{margin-bottom:15px}
.form-label{font-size:11px;font-weight:600;color:var(--sub);margin-bottom:5px;display:flex;align-items:center;gap:4px;letter-spacing:0.02em}
.form-label .req{color:var(--red);font-size:9px;font-weight:700}
.select-grid{display:grid;grid-template-columns:1fr 1fr;gap:7px}
.select-grid.cols3{grid-template-columns:1fr 1fr 1fr}
.sel-btn{
  padding:11px 6px;border:2px solid var(--border);border-radius:11px;
  background:var(--card);cursor:pointer;text-align:center;
  font-size:12px;font-weight:600;transition:all .15s;
  display:flex;flex-direction:column;align-items:center;gap:3px;
  font-family:inherit;color:var(--text);
}
.sel-btn:active{transform:scale(.97)}
.sel-btn.on{border-color:var(--gold);background:rgba(201,168,76,0.06);color:var(--gold-dark)}
.sel-btn .sel-icon{font-size:20px}
.text-input{
  width:100%;padding:13px 14px;border:2px solid var(--border);border-radius:11px;
  font-size:16px;font-family:inherit;outline:none;transition:border .2s;
  background:var(--card);color:var(--text);-webkit-appearance:none;
}
.text-input:focus{border-color:var(--gold)}
.text-input::placeholder{color:#c5cdd8}
.amount-wrap{position:relative}
.amount-wrap .unit{position:absolute;right:14px;top:50%;transform:translateY(-50%);font-size:13px;color:var(--sub);font-weight:600;pointer-events:none}
.date-input{width:100%;padding:13px 14px;border:2px solid var(--border);border-radius:11px;font-size:14px;font-family:inherit;outline:none;background:var(--card);color:var(--text);-webkit-appearance:none;transition:border .2s}
.date-input:focus{border-color:var(--gold)}
.quick-amounts{display:flex;gap:5px;margin-top:7px;flex-wrap:wrap}
.qa{
  padding:5px 13px;border-radius:20px;border:1.5px solid var(--border);
  background:var(--card);font-size:11px;font-weight:600;cursor:pointer;
  font-family:inherit;color:var(--sub);transition:all .15s;
}
.qa:active{transform:scale(.95)}
.qa.on{border-color:var(--gold);color:var(--gold-dark);background:rgba(201,168,76,0.06)}
.photo-area{
  border:2px dashed var(--border);border-radius:11px;padding:20px;
  text-align:center;cursor:pointer;transition:all .2s;
}
.photo-area:hover{border-color:var(--gold);background:rgba(201,168,76,0.03)}
.photo-area .ph-icon{font-size:28px;margin-bottom:4px}
.photo-area .ph-text{font-size:11px;color:var(--sub)}
.submit-btn{
  width:100%;padding:15px;border:none;border-radius:13px;
  background:linear-gradient(135deg,var(--navy) 0%,var(--navy-mid) 100%);
  color:var(--gold);font-size:15px;font-weight:800;cursor:pointer;
  font-family:inherit;box-shadow:0 4px 20px rgba(12,25,41,0.3);
  transition:all .15s;letter-spacing:0.03em;
  border:1px solid rgba(201,168,76,0.2);
}
.submit-btn:active{transform:scale(.98)}
.submit-btn:disabled{opacity:.3;cursor:default}
.impact-box{
  background:linear-gradient(135deg,rgba(201,168,76,0.06),rgba(201,168,76,0.02));
  border:1px solid rgba(201,168,76,0.2);border-radius:12px;
  padding:14px;margin-bottom:14px;display:none;
}
.impact-title{font-size:11px;font-weight:700;color:var(--gold-dark);margin-bottom:6px}

/* ===== MODAL ===== */
.overlay{
  position:fixed;top:0;left:0;right:0;bottom:0;
  background:rgba(12,25,41,.5);z-index:200;
  display:none;align-items:flex-end;justify-content:center;
  backdrop-filter:blur(3px);
}
.overlay.show{display:flex}
.modal{
  background:#fff;border-radius:20px 20px 0 0;
  max-width:430px;width:100%;
  padding:18px 18px calc(18px + env(safe-area-inset-bottom));
  max-height:85vh;overflow-y:auto;animation:su .3s ease;
}
@keyframes su{from{transform:translateY(100%)}to{transform:translateY(0)}}
.m-handle{width:36px;height:4px;background:#d1d5db;border-radius:2px;margin:0 auto 14px}
.d-row{display:flex;justify-content:space-between;padding:10px 0;border-bottom:1px solid var(--border);align-items:center}
.d-label{font-size:11px;color:var(--sub);font-weight:500}
.d-val{font-size:12px;font-weight:700}
.tl-item{display:flex;gap:10px;padding:9px 0;border-bottom:1px solid var(--border);align-items:center}
.tl-date{font-size:10px;color:var(--sub);width:42px;flex-shrink:0;font-weight:500}
.tl-icon{font-size:14px}
.tl-name{font-size:11px;flex:1;font-weight:500}
.tl-amt{font-size:12px;font-weight:700;white-space:nowrap;font-family:'DM Sans',sans-serif}
.tl-amt.inc{color:var(--green)}.tl-amt.exp{color:var(--red)}

/* ===== TOAST ===== */
.toast{
  position:fixed;top:70px;left:50%;transform:translateX(-50%) translateY(-16px);
  background:var(--navy);color:var(--gold);padding:10px 22px;border-radius:12px;
  font-size:12px;font-weight:700;z-index:999;opacity:0;transition:all .3s;
  pointer-events:none;box-shadow:0 8px 24px rgba(12,25,41,.25);
  display:flex;align-items:center;gap:6px;
  border:1px solid rgba(201,168,76,0.2);
}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0)}

/* ===== SUCCESS ===== */
.success-overlay{
  position:fixed;top:0;left:0;right:0;bottom:0;z-index:300;
  background:rgba(255,255,255,.96);display:none;
  flex-direction:column;align-items:center;justify-content:center;
}
.success-overlay.show{display:flex}
.success-check{
  width:80px;height:80px;border-radius:50%;
  background:linear-gradient(135deg,var(--navy),var(--navy-mid));
  display:flex;align-items:center;justify-content:center;
  animation:pop .4s ease;box-shadow:0 8px 32px rgba(12,25,41,0.2);
  border:2px solid rgba(201,168,76,0.3);
}
.success-check span{font-size:36px}
@keyframes pop{0%{transform:scale(0)}50%{transform:scale(1.15)}100%{transform:scale(1)}}
.success-text{font-size:18px;font-weight:800;margin-top:16px;color:var(--navy)}
.success-sub{font-size:12px;color:var(--sub);margin-top:5px}

/* ===== BOTTOM NAV ===== */
.bnav{
  position:fixed;bottom:0;left:50%;transform:translateX(-50%);
  width:100%;max-width:430px;background:#fff;
  border-top:1px solid var(--border);
  display:flex;padding:5px 0 calc(5px + env(safe-area-inset-bottom));z-index:100;
}
.bnav a{
  flex:1;display:flex;flex-direction:column;align-items:center;gap:2px;
  padding:5px 0;cursor:pointer;color:var(--sub);font-size:9px;
  transition:color .15s;text-decoration:none;font-weight:600;
  -webkit-tap-highlight-color:transparent;letter-spacing:0.02em;
}
.bnav a.on{color:var(--gold-dark)}
.bnav a .ni{font-size:18px;position:relative}

/* ===== SCREEN ===== */
.screen{display:none}.screen.active{display:block}
@keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}
.fade-in{animation:fadeIn .2s ease}

/* ===== SPLASH ===== */
.splash{
  position:fixed;top:0;left:0;right:0;bottom:0;z-index:500;
  background:linear-gradient(160deg,#0c1929 0%,#152440 40%,#1a3058 70%,#1e3966 100%);
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  transition:opacity .5s ease;
}
.splash.hide{opacity:0;pointer-events:none}
.splash-logo{animation:splashIn .8s ease}
@keyframes splashIn{from{opacity:0;transform:translateY(20px) scale(.9)}to{opacity:1;transform:translateY(0) scale(1)}}
.splash-tagline{
  font-family:'Cormorant Garamond',serif;
  font-size:13px;color:rgba(201,168,76,0.6);font-style:italic;
  margin-top:16px;letter-spacing:0.08em;
  animation:splashIn .8s ease .3s both;
}
.splash-loading{
  margin-top:32px;width:120px;height:2px;background:rgba(255,255,255,0.1);
  border-radius:1px;overflow:hidden;animation:splashIn .8s ease .5s both;
}
.splash-loading div{
  height:100%;background:var(--gold);border-radius:1px;
  animation:loadBar 1.2s ease .6s both;
}
@keyframes loadBar{from{width:0}to{width:100%}}

/* Scrollbar */
::-webkit-scrollbar{width:3px}
::-webkit-scrollbar-thumb{background:rgba(201,168,76,0.2);border-radius:2px}
</style>
</head>
<body>

<!-- ===== SPLASH SCREEN ===== -->
<div class="splash" id="splash">
  <div class="splash-logo">
    <svg width="72" height="72" viewBox="0 0 72 72" fill="none">
      <!-- Wing left -->
      <path d="M18 36 C14 28, 8 24, 4 22 C10 26, 14 30, 18 36" stroke="rgba(201,168,76,0.4)" stroke-width="1.2" fill="none"/>
      <path d="M20 36 C16 30, 10 26, 6 25 C12 28, 16 32, 20 36" stroke="rgba(201,168,76,0.3)" stroke-width="1" fill="none"/>
      <path d="M22 36 C18 32, 12 28, 8 28 C14 30, 18 33, 22 36" stroke="rgba(201,168,76,0.2)" stroke-width="0.8" fill="none"/>
      <!-- Wing right -->
      <path d="M54 36 C58 28, 64 24, 68 22 C62 26, 58 30, 54 36" stroke="rgba(201,168,76,0.4)" stroke-width="1.2" fill="none"/>
      <path d="M52 36 C56 30, 62 26, 66 25 C60 28, 56 32, 52 36" stroke="rgba(201,168,76,0.3)" stroke-width="1" fill="none"/>
      <path d="M50 36 C54 32, 60 28, 64 28 C58 30, 54 33, 50 36" stroke="rgba(201,168,76,0.2)" stroke-width="0.8" fill="none"/>
      <!-- Shield -->
      <path d="M28 24 L36 20 L44 24 L44 40 C44 48 36 54 36 54 C36 54 28 48 28 40Z" stroke="rgba(201,168,76,0.7)" stroke-width="1.5" fill="rgba(201,168,76,0.06)"/>
      <!-- Yen symbol -->
      <text x="36" y="42" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="16" font-weight="700" fill="rgba(201,168,76,0.8)">Â¥</text>
    </svg>
  </div>
  <div style="text-align:center;margin-top:8px">
    <div style="font-size:26px;font-weight:900;color:#fff;letter-spacing:0.02em">ã‚«ãƒãƒŸã‚¨ãƒ«</div>
    <div style="font-family:'Cormorant Garamond',serif;font-size:14px;color:var(--gold);letter-spacing:0.2em;margin-top:4px;font-weight:600">KANEMIEL</div>
  </div>
  <div class="splash-tagline">â€” Guardian of your cash flow â€”</div>
  <div class="splash-loading"><div></div></div>
</div>

<!-- ===== ROLE BAR ===== -->
<div class="role-bar">
  ğŸ‘¤ <span id="role-label">çµŒå–¶è€…ï¼ˆç¤¾é•·ï¼‰</span>
  <button class="role-switch" onclick="cycleRole()">åˆ‡æ›¿ â–¸</button>
</div>

<!-- ===== HEADER ===== -->
<div class="header">
  <div class="logo-mark">
    <div class="logo-icon">
      <svg viewBox="0 0 36 36" fill="none">
        <path d="M10 12 L18 8 L26 12 L26 22 C26 28 18 32 18 32 C18 32 10 28 10 22Z" stroke="rgba(201,168,76,0.8)" stroke-width="1.2" fill="rgba(201,168,76,0.08)"/>
        <path d="M6 18 C4 14, 2 12, 0 11 C2 13, 4 15, 6 18" stroke="rgba(201,168,76,0.5)" stroke-width="0.8" fill="none"/>
        <path d="M30 18 C32 14, 34 12, 36 11 C34 13, 32 15, 30 18" stroke="rgba(201,168,76,0.5)" stroke-width="0.8" fill="none"/>
        <text x="18" y="22" text-anchor="middle" font-family="DM Sans" font-size="10" font-weight="700" fill="rgba(201,168,76,0.9)">Â¥</text>
      </svg>
    </div>
    <div class="logo-text">
      <span class="logo-jp">ã‚«ãƒãƒŸã‚¨ãƒ«</span>
      <span class="logo-en">Kanemiel</span>
    </div>
  </div>
  <div class="header-right">
    <div class="h-icon" onclick="nav('approval')">ğŸ””<div class="badge" id="badge-count">3</div></div>
    <div class="h-icon" onclick="nav('settings')">â‰¡</div>
  </div>
</div>

<div class="toast" id="toast"></div>
<div class="success-overlay" id="success-overlay">
  <div class="success-check"><span>âœ“</span></div>
  <div class="success-text" id="success-text">ç”³è«‹ã—ã¾ã—ãŸ</div>
  <div class="success-sub" id="success-sub">æ‰¿èªè€…ã«é€šçŸ¥ãŒé€ä¿¡ã•ã‚Œã¾ã—ãŸ</div>
</div>

<!-- ==================== DASHBOARD ==================== -->
<div id="s-dashboard" class="screen active">
<div class="content fade-in">
  <div class="balance">
    <div class="balance-wing">ğŸ›¡</div>
    <div class="balance-top">
      <div class="balance-label" id="bal-label">ä¼šç¤¾ã®ç¾åœ¨æ®‹é«˜</div>
      <div class="balance-badge">LIVE</div>
    </div>
    <div class="balance-num" id="bal-num">1,520<small>ä¸‡å††</small></div>
    <div class="balance-sub">2025å¹´2æœˆ24æ—¥ ç¾åœ¨</div>
  </div>

  <div class="signals" id="signals-area">
    <div class="sig on" onclick="sigSel(this)"><div class="sig-label">ä»Šæœˆ</div><div class="sig-icon">ğŸŸ¢</div><div class="sig-val g">+320ä¸‡</div></div>
    <div class="sig" onclick="sigSel(this)"><div class="sig-label">æ¥æœˆ</div><div class="sig-icon">ğŸŸ¡</div><div class="sig-val y">+45ä¸‡</div></div>
    <div class="sig" onclick="sigSel(this)"><div class="sig-label">å†æ¥æœˆ</div><div class="sig-icon">ğŸ”´</div><div class="sig-val r">-180ä¸‡</div></div>
  </div>

  <div class="card" style="padding:14px" id="chart-area">
    <div class="chart-title">ğŸ“ˆ æ®‹é«˜æ¨ç§»ï¼ˆ3ãƒ¶æœˆäºˆæ¸¬ï¼‰</div>
    <svg viewBox="0 0 370 150" style="width:100%">
      <defs><linearGradient id="aGrad" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#c9a84c"/><stop offset="100%" stop-color="#c9a84c" stop-opacity="0"/></linearGradient></defs>
      <line x1="40" y1="18" x2="345" y2="18" class="gridline"/><line x1="40" y1="48" x2="345" y2="48" class="gridline"/><line x1="40" y1="78" x2="345" y2="78" class="gridline"/><line x1="40" y1="108" x2="345" y2="108" class="gridline"/>
      <text x="36" y="22" class="ylab" text-anchor="end">2000</text><text x="36" y="52" class="ylab" text-anchor="end">1500</text><text x="36" y="82" class="ylab" text-anchor="end">1000</text><text x="36" y="112" class="ylab" text-anchor="end">500</text>
      <line x1="40" y1="125" x2="345" y2="125" class="dline"/><text x="350" y="128" class="dlabel">å±é™º</text>
      <path class="main-area" d="M58,38 L110,32 L162,52 L214,44 L266,76 L318,118 L318,140 L58,140 Z"/>
      <path class="main-line" d="M58,38 L110,32 L162,52 L214,44 L266,76 L318,118"/>
      <circle cx="58" cy="38" r="3.5" class="dot"/><circle cx="110" cy="32" r="3.5" class="dot"/><circle cx="162" cy="52" r="3.5" class="dot"/><circle cx="214" cy="44" r="3.5" class="dot"/><circle cx="266" cy="76" r="3.5" class="dot"/><circle cx="318" cy="118" r="4.5" class="dot-r"/>
      <text x="58" y="32" class="vlabel" text-anchor="middle">1520</text><text x="318" y="113" class="dlabel" text-anchor="middle">320</text>
      <text x="58" y="148" class="xlab" text-anchor="middle">2æœˆ</text><text x="110" y="148" class="xlab" text-anchor="middle">3æœˆä¸Š</text><text x="162" y="148" class="xlab" text-anchor="middle">3æœˆä¸‹</text><text x="214" y="148" class="xlab" text-anchor="middle">4æœˆä¸Š</text><text x="266" y="148" class="xlab" text-anchor="middle">4æœˆä¸‹</text><text x="318" y="148" class="xlab" text-anchor="middle">5æœˆ</text>
    </svg>
    <div class="chart-legend"><div class="leg"><i style="background:var(--gold)"></i>äºˆæ¸¬æ®‹é«˜ï¼ˆä¸‡å††ï¼‰</div><div class="leg"><i style="background:var(--red)"></i>å±é™ºãƒ©ã‚¤ãƒ³</div></div>
  </div>

  <div class="sec-title" id="alert-section">âš ï¸ è¦å¯¾å¿œï¼ˆ3ä»¶ï¼‰</div>
  <div id="alerts-wrap">
    <div class="alert al-r" onclick="nav('approval')"><div class="ic">ğŸ”´</div><div class="body"><div class="ttl">æ”¯æ‰•ã„æ‰¿èªå¾…ã¡ï¼š3ä»¶</div><div class="desc">åˆè¨ˆ 280ä¸‡å††</div></div><div class="arr">â€º</div></div>
    <div class="alert al-y" onclick="openDetail('B')"><div class="ic">ğŸŸ¡</div><div class="body"><div class="ttl">Bç¾å ´ï¼šå…¥é‡‘é…å»¶ 3æ—¥</div><div class="desc">å…ƒè«‹ã‘ã‹ã‚‰ã®å…¥é‡‘ãŒé…å»¶</div></div><div class="arr">â€º</div></div>
    <div class="alert al-r"><div class="ic">ğŸ”´</div><div class="body"><div class="ttl">5æœˆã«è³‡é‡‘ä¸è¶³ã®è¦‹è¾¼ã¿</div><div class="desc">æ®‹é«˜ -180ä¸‡å†† ã®äºˆæ¸¬</div></div><div class="arr">â€º</div></div>
  </div>

  <div class="sec-title" style="margin-top:14px" id="proj-section">ğŸ“‹ ç¾å ´ä¸€è¦§</div>
  <div id="proj-wrap">
    <div class="proj" onclick="openDetail('A')"><div class="proj-top"><div class="proj-name"><span class="ds g"></span>Aç¾å ´ï¼ˆâ—‹â—‹ãƒãƒ³ã‚·ãƒ§ãƒ³ï¼‰</div><div class="proj-amt" style="color:var(--green)">+450ä¸‡</div></div><div class="proj-bar"><div class="proj-fill g" style="width:64%"></div></div><div class="proj-meta"><span>å¥‘ç´„ 5,000ä¸‡ / å…¥é‡‘ 64%</span><span>æ”¯å‡º 55%</span></div></div>
    <div class="proj" onclick="openDetail('B')"><div class="proj-top"><div class="proj-name"><span class="ds g"></span>Bç¾å ´ï¼ˆâ–³â–³ãƒ“ãƒ«æ”¹ä¿®ï¼‰</div><div class="proj-amt" style="color:var(--green)">+230ä¸‡</div></div><div class="proj-bar"><div class="proj-fill g" style="width:45%"></div></div><div class="proj-meta"><span>å¥‘ç´„ 3,200ä¸‡ / å…¥é‡‘ 45%</span><span>æ”¯å‡º 38%</span></div></div>
    <div class="proj" onclick="openDetail('C')"><div class="proj-top"><div class="proj-name"><span class="ds y"></span>Cç¾å ´ï¼ˆâ–¡â–¡ä½å®…ï¼‰</div><div class="proj-amt" style="color:var(--yellow)">+50ä¸‡</div></div><div class="proj-bar"><div class="proj-fill y" style="width:82%"></div></div><div class="proj-meta"><span>å¥‘ç´„ 1,800ä¸‡ / å…¥é‡‘ 82%</span><span>æ”¯å‡º 79%</span></div></div>
    <div class="proj" onclick="openDetail('D')"><div class="proj-top"><div class="proj-name"><span class="ds r"></span>Dç¾å ´ï¼ˆâ—‡â—‡å€‰åº«ï¼‰</div><div class="proj-amt" style="color:var(--red)">-30ä¸‡</div></div><div class="proj-bar"><div class="proj-fill r" style="width:95%"></div></div><div class="proj-meta"><span>å¥‘ç´„ 2,400ä¸‡ / å…¥é‡‘ 72%</span><span>æ”¯å‡º 73%</span></div></div>
  </div>
</div>
</div>

<!-- ==================== APPROVAL ==================== -->
<div id="s-approval" class="screen">
<div class="content fade-in">
  <div style="display:flex;align-items:center;gap:8px;margin-bottom:12px">
    <span style="font-size:16px;cursor:pointer" onclick="nav('dashboard')">â†</span>
    <span style="font-size:15px;font-weight:800">æ‰¿èªå¾…ã¡ä¸€è¦§</span>
  </div>
  <div class="appr-summary">æœªæ‰¿èªï¼š3ä»¶ã€€åˆè¨ˆ 280ä¸‡å††</div>
  <div class="appr" id="appr-1"><div class="appr-head"><div><div class="appr-proj">Aç¾å ´ï¼ˆâ—‹â—‹ãƒãƒ³ã‚·ãƒ§ãƒ³ï¼‰</div><div class="appr-target">â†’ â—‹â—‹å·¥æ¥­ æ ªå¼ä¼šç¤¾</div></div><div class="appr-big">80<small>ä¸‡å††</small></div></div><div class="appr-meta"><div class="appr-row"><span class="l">åŒºåˆ†</span><span>å¤–æ³¨è²»</span></div><div class="appr-row"><span class="l">å¸Œæœ›æ—¥</span><span>3æœˆ15æ—¥</span></div><div class="appr-row"><span class="l">ç”³è«‹è€…</span><span>ç”°ä¸­ å¤ªéƒ</span></div></div><div class="appr-impact safe"><div class="appr-impact-t">ğŸ’¡ æ‰¿èªå¾Œã®æ®‹é«˜</div><div class="appr-row"><span>Aç¾å ´</span><span style="font-weight:700">+370ä¸‡ ğŸŸ¢</span></div><div class="appr-row"><span>ä¼šç¤¾å…¨ä½“</span><span style="font-weight:700">+1,440ä¸‡ ğŸŸ¢</span></div></div><div class="appr-btns"><button class="btn btn-ok" onclick="doApprove('appr-1')">âœ“ æ‰¿èª</button><button class="btn btn-ng">âœ• å·®æˆ»ã—</button></div></div>
  <div class="appr" id="appr-2"><div class="appr-head"><div><div class="appr-proj">Bç¾å ´ï¼ˆâ–³â–³ãƒ“ãƒ«æ”¹ä¿®ï¼‰</div><div class="appr-target">â†’ â–³â–³å»ºæ æ ªå¼ä¼šç¤¾</div></div><div class="appr-big">120<small>ä¸‡å††</small></div></div><div class="appr-meta"><div class="appr-row"><span class="l">åŒºåˆ†</span><span>ææ–™è²»</span></div><div class="appr-row"><span class="l">å¸Œæœ›æ—¥</span><span>2æœˆ28æ—¥</span></div><div class="appr-row"><span class="l">ç”³è«‹è€…</span><span>ä½è—¤ æ¬¡éƒ</span></div></div><div class="appr-impact safe"><div class="appr-impact-t">ğŸ’¡ æ‰¿èªå¾Œã®æ®‹é«˜</div><div class="appr-row"><span>Bç¾å ´</span><span style="font-weight:700">+110ä¸‡ ğŸŸ¢</span></div><div class="appr-row"><span>ä¼šç¤¾å…¨ä½“</span><span style="font-weight:700">+1,400ä¸‡ ğŸŸ¢</span></div></div><div class="appr-btns"><button class="btn btn-ok" onclick="doApprove('appr-2')">âœ“ æ‰¿èª</button><button class="btn btn-ng">âœ• å·®æˆ»ã—</button></div></div>
  <div class="appr" id="appr-3"><div class="appr-head"><div><div class="appr-proj">Cç¾å ´ï¼ˆâ–¡â–¡ä½å®…ï¼‰</div><div class="appr-target">â†’ â–¡â–¡è¨­å‚™ æœ‰é™ä¼šç¤¾</div></div><div class="appr-big">80<small>ä¸‡å††</small></div></div><div class="appr-meta"><div class="appr-row"><span class="l">åŒºåˆ†</span><span>å¤–æ³¨è²»</span></div><div class="appr-row"><span class="l">å¸Œæœ›æ—¥</span><span>3æœˆ10æ—¥</span></div><div class="appr-row"><span class="l">ç”³è«‹è€…</span><span>å±±ç”° ä¸‰éƒ</span></div></div><div class="appr-impact warn"><div class="appr-impact-t">âš ï¸ æ‰¿èªå¾Œã®æ®‹é«˜</div><div class="appr-row"><span>Cç¾å ´</span><span style="font-weight:700;color:var(--yellow)">-30ä¸‡ ğŸŸ¡</span></div><div class="appr-row"><span>ä¼šç¤¾å…¨ä½“</span><span style="font-weight:700">+1,320ä¸‡ ğŸŸ¢</span></div></div><div class="appr-btns"><button class="btn btn-ok" onclick="doApprove('appr-3')">âœ“ æ‰¿èª</button><button class="btn btn-ng">âœ• å·®æˆ»ã—</button></div></div>
</div>
</div>

<!-- ==================== REPORT ==================== -->
<div id="s-report" class="screen">
<div class="content fade-in">
  <div style="font-size:15px;font-weight:800;margin-bottom:12px">ğŸ“Š ãƒ¬ãƒãƒ¼ãƒˆ</div>
  <div class="report-tabs"><div class="rtab on" onclick="switchReport(this,'rep-summary')">å…¨ä½“ã‚µãƒãƒª</div><div class="rtab" onclick="switchReport(this,'rep-site')">ç¾å ´åˆ¥åæ”¯</div><div class="rtab" onclick="switchReport(this,'rep-cashflow')">è³‡é‡‘ç¹°ã‚Šè¡¨</div></div>

  <div id="rep-summary" class="report-panel">
    <div class="kpi-row">
      <div class="kpi"><div class="kpi-label">ä»Šæœˆã®å…¥é‡‘åˆè¨ˆ</div><div class="kpi-val" style="color:var(--green)">+820</div><div class="kpi-sub" style="color:var(--green)">ä¸‡å††</div></div>
      <div class="kpi"><div class="kpi-label">ä»Šæœˆã®æ”¯å‡ºåˆè¨ˆ</div><div class="kpi-val" style="color:var(--red)">-500</div><div class="kpi-sub" style="color:var(--red)">ä¸‡å††</div></div>
    </div>
    <div class="kpi-row">
      <div class="kpi"><div class="kpi-label">ä»Šæœˆã®åæ”¯</div><div class="kpi-val" style="color:var(--green)">+320</div><div class="kpi-sub" style="color:var(--green)">ä¸‡å†† é»’å­—</div></div>
      <div class="kpi"><div class="kpi-label">æ‰¿èªå¾…ã¡</div><div class="kpi-val">3</div><div class="kpi-sub" style="color:var(--yellow)">ä»¶ï¼ˆ280ä¸‡å††ï¼‰</div></div>
    </div>
    <div class="card card-pad">
      <div class="chart-title">ğŸ“Š æœˆåˆ¥åæ”¯æ¨ç§»</div>
      <svg viewBox="0 0 360 120" style="width:100%">
        <rect x="30" y="30" width="28" height="56" rx="4" fill="rgba(34,181,115,0.15)"/><rect x="34" y="44" width="20" height="42" rx="3" fill="var(--green)" opacity=".7"/>
        <rect x="90" y="20" width="28" height="66" rx="4" fill="rgba(34,181,115,0.15)"/><rect x="94" y="38" width="20" height="48" rx="3" fill="var(--green)" opacity=".7"/>
        <rect x="150" y="24" width="28" height="62" rx="4" fill="rgba(34,181,115,0.15)"/><rect x="154" y="36" width="20" height="50" rx="3" fill="var(--green)" opacity=".7"/>
        <rect x="210" y="14" width="28" height="72" rx="4" fill="rgba(34,181,115,0.15)"/><rect x="214" y="32" width="20" height="54" rx="3" fill="var(--green)" opacity=".7"/>
        <rect x="270" y="10" width="28" height="76" rx="4" fill="rgba(201,168,76,0.15)"/><rect x="274" y="16" width="20" height="70" rx="3" fill="var(--gold)" opacity=".7"/>
        <text x="44" y="104" class="xlab" text-anchor="middle">10æœˆ</text><text x="104" y="104" class="xlab" text-anchor="middle">11æœˆ</text><text x="164" y="104" class="xlab" text-anchor="middle">12æœˆ</text><text x="224" y="104" class="xlab" text-anchor="middle">1æœˆ</text><text x="284" y="104" class="xlab" text-anchor="middle">2æœˆ</text>
        <text x="44" y="25" class="vlabel" text-anchor="middle" font-size="8">+180</text><text x="104" y="15" class="vlabel" text-anchor="middle" font-size="8">+250</text><text x="164" y="19" class="vlabel" text-anchor="middle" font-size="8">+210</text><text x="224" y="9" class="vlabel" text-anchor="middle" font-size="8">+300</text><text x="284" y="5" class="vlabel" text-anchor="middle" font-size="8">+320</text>
      </svg>
      <div class="chart-legend"><div class="leg"><i style="background:rgba(34,181,115,0.15);border:1px solid var(--green)"></i>å…¥é‡‘</div><div class="leg"><i style="background:var(--green)"></i>æ”¯å‡º</div></div>
    </div>
    <div class="card card-pad" style="margin-top:8px">
      <div class="chart-title">ğŸ—ï¸ ç¾å ´åˆ¥ å¥å…¨åº¦</div>
      <div style="display:flex;flex-direction:column;gap:8px">
        <div style="display:flex;align-items:center;gap:8px"><span style="font-size:11px;width:80px;font-weight:600">Aç¾å ´</span><div style="flex:1;height:18px;display:flex;border-radius:4px;overflow:hidden;gap:1px"><div style="width:64%;background:var(--green);border-radius:4px 0 0 4px"></div><div style="width:36%;background:#edf0f5;border-radius:0 4px 4px 0"></div></div><span style="font-size:10px;font-weight:700;color:var(--green);width:40px;text-align:right">ğŸŸ¢</span></div>
        <div style="display:flex;align-items:center;gap:8px"><span style="font-size:11px;width:80px;font-weight:600">Bç¾å ´</span><div style="flex:1;height:18px;display:flex;border-radius:4px;overflow:hidden;gap:1px"><div style="width:45%;background:var(--green);border-radius:4px 0 0 4px"></div><div style="width:55%;background:#edf0f5;border-radius:0 4px 4px 0"></div></div><span style="font-size:10px;font-weight:700;color:var(--green);width:40px;text-align:right">ğŸŸ¢</span></div>
        <div style="display:flex;align-items:center;gap:8px"><span style="font-size:11px;width:80px;font-weight:600">Cç¾å ´</span><div style="flex:1;height:18px;display:flex;border-radius:4px;overflow:hidden;gap:1px"><div style="width:82%;background:var(--yellow);border-radius:4px 0 0 4px"></div><div style="width:18%;background:#edf0f5;border-radius:0 4px 4px 0"></div></div><span style="font-size:10px;font-weight:700;color:var(--yellow);width:40px;text-align:right">ğŸŸ¡</span></div>
        <div style="display:flex;align-items:center;gap:8px"><span style="font-size:11px;width:80px;font-weight:600">Dç¾å ´</span><div style="flex:1;height:18px;display:flex;border-radius:4px;overflow:hidden;gap:1px"><div style="width:95%;background:var(--red);border-radius:4px 0 0 4px"></div><div style="width:5%;background:#edf0f5;border-radius:0 4px 4px 0"></div></div><span style="font-size:10px;font-weight:700;color:var(--red);width:40px;text-align:right">ğŸ”´</span></div>
      </div>
    </div>
  </div>

  <div id="rep-site" class="report-panel" style="display:none">
    <div class="card card-pad"><div class="chart-title">ğŸ—ï¸ ç¾å ´åˆ¥ åæ”¯ä¸€è¦§</div><div style="overflow-x:auto"><table class="report-table"><thead><tr><th>ç¾å ´</th><th class="num">å¥‘ç´„</th><th class="num">å…¥é‡‘</th><th class="num">æ”¯å‡º</th><th class="num">æ®‹é«˜</th><th>çŠ¶æ…‹</th></tr></thead><tbody><tr><td style="font-weight:600">A</td><td class="num">5,000</td><td class="num" style="color:var(--green)">3,200</td><td class="num" style="color:var(--red)">2,750</td><td class="num" style="font-weight:700;color:var(--green)">+450</td><td>ğŸŸ¢</td></tr><tr><td style="font-weight:600">B</td><td class="num">3,200</td><td class="num" style="color:var(--green)">1,440</td><td class="num" style="color:var(--red)">1,216</td><td class="num" style="font-weight:700;color:var(--green)">+230</td><td>ğŸŸ¢</td></tr><tr><td style="font-weight:600">C</td><td class="num">1,800</td><td class="num" style="color:var(--green)">1,476</td><td class="num" style="color:var(--red)">1,422</td><td class="num" style="font-weight:700;color:var(--yellow)">+50</td><td>ğŸŸ¡</td></tr><tr><td style="font-weight:600">D</td><td class="num">2,400</td><td class="num" style="color:var(--green)">1,728</td><td class="num" style="color:var(--red)">1,752</td><td class="num" style="font-weight:700;color:var(--red)">-30</td><td>ğŸ”´</td></tr><tr class="total-row"><td>åˆè¨ˆ</td><td class="num">12,400</td><td class="num">7,844</td><td class="num">7,140</td><td class="num" style="color:var(--green)">+700</td><td></td></tr></tbody></table></div><div style="font-size:9px;color:var(--sub);margin-top:6px;text-align:right">å˜ä½ï¼šä¸‡å††</div></div>
    <div class="card card-pad" style="margin-top:8px"><div class="chart-title">ğŸ“‹ æ”¯å‡ºåŒºåˆ†ã®å†…è¨³</div><div style="display:flex;height:24px;border-radius:5px;overflow:hidden;gap:1px;margin-bottom:8px"><div style="width:45%;background:var(--navy)"></div><div style="width:25%;background:var(--gold)"></div><div style="width:15%;background:var(--green)"></div><div style="width:10%;background:var(--yellow)"></div><div style="width:5%;background:#94a3b8"></div></div><div style="display:flex;flex-wrap:wrap;gap:8px;font-size:10px"><span style="display:flex;align-items:center;gap:3px"><i style="width:8px;height:8px;border-radius:2px;background:var(--navy);display:inline-block"></i>å¤–æ³¨ 45%</span><span style="display:flex;align-items:center;gap:3px"><i style="width:8px;height:8px;border-radius:2px;background:var(--gold);display:inline-block"></i>ææ–™ 25%</span><span style="display:flex;align-items:center;gap:3px"><i style="width:8px;height:8px;border-radius:2px;background:var(--green);display:inline-block"></i>æ©Ÿæ 15%</span><span style="display:flex;align-items:center;gap:3px"><i style="width:8px;height:8px;border-radius:2px;background:var(--yellow);display:inline-block"></i>äº¤é€š 10%</span><span style="display:flex;align-items:center;gap:3px"><i style="width:8px;height:8px;border-radius:2px;background:#94a3b8;display:inline-block"></i>ä»– 5%</span></div></div>
  </div>

  <div id="rep-cashflow" class="report-panel" style="display:none">
    <div class="card card-pad"><div class="chart-title">ğŸ’´ æœˆæ¬¡è³‡é‡‘ç¹°ã‚Šè¡¨</div><div style="overflow-x:auto"><table class="report-table"><thead><tr><th></th><th class="num">2æœˆ</th><th class="num">3æœˆ</th><th class="num">4æœˆ</th><th class="num">5æœˆ</th></tr></thead><tbody><tr style="background:var(--green-bg)"><td style="font-weight:600">æœˆåˆæ®‹é«˜</td><td class="num">1,200</td><td class="num">1,520</td><td class="num">1,565</td><td class="num" style="color:var(--yellow)">1,385</td></tr><tr><td>å…¥é‡‘åˆè¨ˆ</td><td class="num" style="color:var(--green)">+820</td><td class="num" style="color:var(--green)">+650</td><td class="num" style="color:var(--green)">+500</td><td class="num" style="color:var(--green)">+300</td></tr><tr><td>ã€€å…ƒè«‹å…¥é‡‘</td><td class="num">700</td><td class="num">550</td><td class="num">400</td><td class="num">200</td></tr><tr><td>ã€€ãã®ä»–</td><td class="num">120</td><td class="num">100</td><td class="num">100</td><td class="num">100</td></tr><tr><td>æ”¯å‡ºåˆè¨ˆ</td><td class="num" style="color:var(--red)">-500</td><td class="num" style="color:var(--red)">-605</td><td class="num" style="color:var(--red)">-680</td><td class="num" style="color:var(--red)">-800</td></tr><tr><td>ã€€å¤–æ³¨è²»</td><td class="num">240</td><td class="num">300</td><td class="num">320</td><td class="num">400</td></tr><tr><td>ã€€ææ–™è²»</td><td class="num">150</td><td class="num">180</td><td class="num">200</td><td class="num">250</td></tr><tr><td>ã€€ãã®ä»–</td><td class="num">110</td><td class="num">125</td><td class="num">160</td><td class="num">150</td></tr><tr class="total-row"><td>æœˆæœ«æ®‹é«˜</td><td class="num" style="color:var(--green);font-size:13px">1,520</td><td class="num" style="color:var(--green);font-size:13px">1,565</td><td class="num" style="color:var(--yellow);font-size:13px">1,385</td><td class="num" style="color:var(--red);font-size:13px;font-weight:900">885</td></tr><tr><td>çŠ¶æ…‹</td><td class="num">ğŸŸ¢</td><td class="num">ğŸŸ¢</td><td class="num">ğŸŸ¡</td><td class="num">ğŸ”´</td></tr></tbody></table></div><div style="font-size:9px;color:var(--sub);margin-top:6px;text-align:right">å˜ä½ï¼šä¸‡å††</div></div>
    <div style="background:var(--red-bg);border:1px solid var(--red-light);border-radius:11px;padding:12px;margin-top:8px"><div style="font-size:12px;font-weight:700;color:var(--red);margin-bottom:3px">âš ï¸ è³‡é‡‘ç¹°ã‚Šã®æ³¨æ„</div><div style="font-size:11px;color:var(--red);line-height:1.6">5æœˆã¯æ”¯å‡ºãŒå¤§å¹…å¢—åŠ ã—æ®‹é«˜ãŒå±é™ºæ°´æº–ã«æ¥è¿‘ã€‚4æœˆä¸­ã«å…ƒè«‹ã‘ã¸ã®å…¥é‡‘äº¤æ¸‰ã‚’æ¤œè¨ã—ã¦ãã ã•ã„ã€‚</div></div>
  </div>
</div>
</div>

<!-- ==================== INPUT ==================== -->
<div id="s-input" class="screen">
<div class="content fade-in">
  <div style="font-size:15px;font-weight:800;margin-bottom:12px">ï¼‹ å…¥åŠ›</div>
  <div class="input-type-toggle"><div class="itt on" onclick="switchInput(this,'input-pay')">ğŸ’¸ æ”¯æ‰•ã„ç”³è«‹</div><div class="itt" onclick="switchInput(this,'input-inc')">ğŸ’° å…¥é‡‘ç™»éŒ²</div></div>

  <div id="input-pay" class="input-panel">
    <div class="form-group"><div class="form-label">ğŸ—ï¸ ç¾å ´ <span class="req">å¿…é ˆ</span></div><div class="select-grid"><button class="sel-btn" onclick="sel(this,'site')"><span class="sel-icon">ğŸ¢</span>Aç¾å ´</button><button class="sel-btn" onclick="sel(this,'site')"><span class="sel-icon">ğŸ¢</span>Bç¾å ´</button><button class="sel-btn" onclick="sel(this,'site')"><span class="sel-icon">ğŸ </span>Cç¾å ´</button><button class="sel-btn" onclick="sel(this,'site')"><span class="sel-icon">ğŸ­</span>Dç¾å ´</button></div></div>
    <div class="form-group"><div class="form-label">ğŸª æ”¯æ‰•å…ˆ <span class="req">å¿…é ˆ</span></div><div class="select-grid"><button class="sel-btn" onclick="sel(this,'vendor')">â—‹â—‹å·¥æ¥­</button><button class="sel-btn" onclick="sel(this,'vendor')">â–³â–³å»ºæ</button><button class="sel-btn" onclick="sel(this,'vendor')">â–¡â–¡è¨­å‚™</button><button class="sel-btn" onclick="sel(this,'vendor')" style="border-style:dashed;color:var(--sub)">ï¼‹ æ–°è¦è¿½åŠ </button></div></div>
    <div class="form-group"><div class="form-label">ğŸ’´ é‡‘é¡ <span class="req">å¿…é ˆ</span></div><div class="amount-wrap"><input type="number" class="text-input" id="pay-amount" placeholder="é‡‘é¡ã‚’å…¥åŠ›" inputmode="numeric" oninput="checkForm()"><span class="unit">ä¸‡å††</span></div><div class="quick-amounts"><button class="qa" onclick="setAmt(this,10)">10ä¸‡</button><button class="qa" onclick="setAmt(this,30)">30ä¸‡</button><button class="qa" onclick="setAmt(this,50)">50ä¸‡</button><button class="qa" onclick="setAmt(this,80)">80ä¸‡</button><button class="qa" onclick="setAmt(this,100)">100ä¸‡</button><button class="qa" onclick="setAmt(this,150)">150ä¸‡</button></div></div>
    <div class="form-group"><div class="form-label">ğŸ“… æ”¯æ‰•å¸Œæœ›æ—¥ <span class="req">å¿…é ˆ</span></div><input type="date" class="date-input" id="pay-date" value="2025-03-15" onchange="checkForm()"></div>
    <div class="form-group"><div class="form-label">ğŸ“‚ åŒºåˆ† <span class="req">å¿…é ˆ</span></div><div class="select-grid cols3"><button class="sel-btn" onclick="sel(this,'cat')"><span class="sel-icon">ğŸ‘·</span>å¤–æ³¨è²»</button><button class="sel-btn" onclick="sel(this,'cat')"><span class="sel-icon">ğŸ§±</span>ææ–™è²»</button><button class="sel-btn" onclick="sel(this,'cat')"><span class="sel-icon">ğŸšœ</span>æ©Ÿæ</button><button class="sel-btn" onclick="sel(this,'cat')"><span class="sel-icon">ğŸš—</span>äº¤é€šè²»</button><button class="sel-btn" onclick="sel(this,'cat')"><span class="sel-icon">ğŸ“¦</span>ãã®ä»–</button></div></div>
    <div class="form-group"><div class="form-label">ğŸ“ å‚™è€ƒï¼ˆãªãã¦ã‚‚OKï¼‰</div><input type="text" class="text-input" placeholder="ä¾‹ï¼š3æœˆåˆ†ã®å¤–å£å·¥äº‹è²»"></div>
    <div class="form-group"><div class="form-label">ğŸ“· å†™çœŸï¼ˆè«‹æ±‚æ›¸ãªã©ï¼‰</div><div class="photo-area" onclick="this.innerHTML='<div class=\'ph-icon\'>ğŸ“</div><div class=\'ph-text\' style=\'color:var(--gold-dark);font-weight:600\'>è«‹æ±‚æ›¸_20250301.jpg</div>'"><div class="ph-icon">ğŸ“·</div><div class="ph-text">ã‚¿ãƒƒãƒ—ã—ã¦æ’®å½± or ç”»åƒã‚’é¸æŠ</div></div></div>
    <div class="impact-box" id="impact-preview"><div class="impact-title">ğŸ’¡ ã“ã®ç”³è«‹ã‚’æ‰¿èªã™ã‚‹ã¨...</div><div class="appr-row"><span class="l">ç¾å ´æ®‹é«˜</span><span style="font-weight:700" id="impact-site">â€”</span></div><div class="appr-row"><span class="l">ä¼šç¤¾å…¨ä½“</span><span style="font-weight:700" id="impact-total">â€”</span></div></div>
    <button class="submit-btn" id="submit-pay" disabled onclick="submitPay()">ç”³è«‹ã™ã‚‹</button>
    <div style="text-align:center;margin-top:6px;font-size:10px;color:var(--sub)">æ‰¿èªè€…ã«é€šçŸ¥ãŒå±Šãã¾ã™</div>
  </div>

  <div id="input-inc" class="input-panel" style="display:none">
    <div class="form-group"><div class="form-label">ğŸ—ï¸ ç¾å ´ <span class="req">å¿…é ˆ</span></div><div class="select-grid"><button class="sel-btn" onclick="sel(this,'i-site')"><span class="sel-icon">ğŸ¢</span>Aç¾å ´</button><button class="sel-btn" onclick="sel(this,'i-site')"><span class="sel-icon">ğŸ¢</span>Bç¾å ´</button><button class="sel-btn" onclick="sel(this,'i-site')"><span class="sel-icon">ğŸ </span>Cç¾å ´</button><button class="sel-btn" onclick="sel(this,'i-site')"><span class="sel-icon">ğŸ­</span>Dç¾å ´</button></div></div>
    <div class="form-group"><div class="form-label">ğŸª å…¥é‡‘å…ƒ <span class="req">å¿…é ˆ</span></div><div class="select-grid"><button class="sel-btn" onclick="sel(this,'i-from')">â—â—å»ºè¨­ï¼ˆå…ƒè«‹ï¼‰</button><button class="sel-btn" onclick="sel(this,'i-from')">â–³â–³ãƒã‚¦ã‚¹ï¼ˆå…ƒè«‹ï¼‰</button><button class="sel-btn" onclick="sel(this,'i-from')" style="border-style:dashed;color:var(--sub)">ï¼‹ æ–°è¦è¿½åŠ </button></div></div>
    <div class="form-group"><div class="form-label">ğŸ’´ é‡‘é¡ <span class="req">å¿…é ˆ</span></div><div class="amount-wrap"><input type="number" class="text-input" placeholder="é‡‘é¡ã‚’å…¥åŠ›" inputmode="numeric"><span class="unit">ä¸‡å††</span></div></div>
    <div class="form-group"><div class="form-label">ğŸ“… å…¥é‡‘æ—¥</div><input type="date" class="date-input" value="2025-03-15"></div>
    <div class="form-group"><div class="form-label">ğŸ“‚ ç¨®åˆ¥</div><div class="select-grid cols3"><button class="sel-btn on" onclick="sel(this,'i-type')"><span class="sel-icon">ğŸ“„</span>å‡ºæ¥é«˜</button><button class="sel-btn" onclick="sel(this,'i-type')"><span class="sel-icon">ğŸ’°</span>å‰å—é‡‘</button><button class="sel-btn" onclick="sel(this,'i-type')"><span class="sel-icon">âœ…</span>æœ€çµ‚é‡‘</button></div></div>
    <button class="submit-btn" onclick="submitInc()" style="margin-top:8px">å…¥é‡‘ã‚’ç™»éŒ²ã™ã‚‹</button>
    <div style="text-align:center;margin-top:6px;font-size:10px;color:var(--sub)">æ®‹é«˜ãƒ»äºˆæ¸¬ã«å³æ™‚åæ˜ ã•ã‚Œã¾ã™</div>
  </div>
</div>
</div>

<!-- ==================== SETTINGS ==================== -->
<div id="s-settings" class="screen">
<div class="content fade-in">
  <div style="font-size:15px;font-weight:800;margin-bottom:12px">âš™ï¸ è¨­å®š</div>
  <div class="card card-pad">
    <div class="d-row"><span class="d-label">è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰</span><span class="d-val" id="settings-role">çµŒå–¶è€…</span></div>
    <div class="d-row"><span class="d-label">LINEé€šçŸ¥</span><span class="d-val" style="color:var(--green)">ON</span></div>
    <div class="d-row"><span class="d-label">å±é™ºãƒ©ã‚¤ãƒ³</span><span class="d-val">200ä¸‡å††</span></div>
    <div class="d-row" style="border:none"><span class="d-label">ãƒãƒ¼ã‚¸ãƒ§ãƒ³</span><span class="d-val" style="color:var(--sub);font-family:'Cormorant Garamond',serif;font-size:13px">Kanemiel v0.1</span></div>
  </div>
</div>
</div>

<!-- ===== DETAIL MODAL ===== -->
<div id="detail-overlay" class="overlay" onclick="closeDetail(event)">
<div class="modal" onclick="event.stopPropagation()">
  <div class="m-handle"></div>
  <h2 id="m-title" style="font-size:15px;font-weight:800;margin-bottom:8px"></h2>
  <div style="display:flex;align-items:center;gap:6px;margin-bottom:12px"><span class="ds" id="m-dot"></span><span id="m-status" style="font-weight:700;font-size:12px"></span></div>
  <div class="d-row"><span class="d-label">å¥‘ç´„é‡‘é¡</span><span class="d-val" id="m-contract"></span></div>
  <div class="d-row"><span class="d-label">å…¥é‡‘æ¸ˆã¿</span><span class="d-val" id="m-income" style="color:var(--green)"></span></div>
  <div class="d-row"><span class="d-label">æ”¯å‡ºæ¸ˆã¿</span><span class="d-val" id="m-expense" style="color:var(--red)"></span></div>
  <div class="d-row" style="border-bottom:2px solid var(--text)"><span class="d-label" style="font-weight:700;color:var(--text)">ç¾å ´æ®‹é«˜</span><span class="d-val" id="m-balance" style="font-size:16px"></span></div>
  <div style="margin-top:14px;font-size:12px;font-weight:700;margin-bottom:4px">ğŸ“… å…¥å‡ºé‡‘ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³</div>
  <div id="m-timeline"></div>
</div>
</div>

<!-- ===== BOTTOM NAV ===== -->
<div class="bnav">
  <a class="on" onclick="nav('dashboard')"><span class="ni">ğŸ </span>ãƒˆãƒƒãƒ—</a>
  <a onclick="nav('approval')" id="nav-approval"><span class="ni">âœ…</span>æ‰¿èª</a>
  <a onclick="nav('input')"><span class="ni">ï¼‹</span>å…¥åŠ›</a>
  <a onclick="nav('report')"><span class="ni">ğŸ“Š</span>ãƒ¬ãƒãƒ¼ãƒˆ</a>
  <a onclick="nav('settings')"><span class="ni">âš™ï¸</span>è¨­å®š</a>
</div>

<script>
// Splash
setTimeout(()=>document.getElementById('splash').classList.add('hide'),2000);

// State
let roleIdx=0;
const roles=[
  {id:'owner',label:'çµŒå–¶è€…ï¼ˆç¤¾é•·ï¼‰'},
  {id:'accounting',label:'çµŒç†æ‹…å½“'},
  {id:'foreman',label:'ç¾å ´ç›£ç£ï¼ˆAç¾å ´æ‹…å½“ï¼‰'}
];
const projects={
  A:{name:'Aç¾å ´ï¼ˆâ—‹â—‹ãƒãƒ³ã‚·ãƒ§ãƒ³æ–°ç¯‰ï¼‰',status:'g',statusText:'å¥å…¨',contract:'5,000ä¸‡å††',income:'3,200ä¸‡å††ï¼ˆ64%ï¼‰',expense:'2,750ä¸‡å††ï¼ˆ55%ï¼‰',balance:'+450ä¸‡å††',balColor:'var(--green)',timeline:[{date:'2/15',icon:'ğŸ”»',name:'â—‹â—‹å·¥æ¥­',amt:'-80ä¸‡',cls:'exp'},{date:'2/28',icon:'ğŸ”»',name:'â–³â–³å»ºæ',amt:'-120ä¸‡',cls:'exp'},{date:'3/15',icon:'ğŸ”º',name:'å…ƒè«‹å…¥é‡‘',amt:'+500ä¸‡',cls:'inc'},{date:'3/20',icon:'ğŸ”»',name:'â—‹â—‹å·¥æ¥­',amt:'-80ä¸‡',cls:'exp'}]},
  B:{name:'Bç¾å ´ï¼ˆâ–³â–³ãƒ“ãƒ«æ”¹ä¿®ï¼‰',status:'g',statusText:'å¥å…¨',contract:'3,200ä¸‡å††',income:'1,440ä¸‡å††ï¼ˆ45%ï¼‰',expense:'1,216ä¸‡å††ï¼ˆ38%ï¼‰',balance:'+230ä¸‡å††',balColor:'var(--green)',timeline:[{date:'2/20',icon:'ğŸ”»',name:'ææ–™ä»•å…¥',amt:'-60ä¸‡',cls:'exp'},{date:'3/01',icon:'ğŸ”º',name:'å…ƒè«‹å…¥é‡‘',amt:'+400ä¸‡',cls:'inc'},{date:'3/15',icon:'ğŸ”»',name:'å¤–æ³¨è²»',amt:'-90ä¸‡',cls:'exp'}]},
  C:{name:'Cç¾å ´ï¼ˆâ–¡â–¡ä½å®…ï¼‰',status:'y',statusText:'æ³¨æ„',contract:'1,800ä¸‡å††',income:'1,476ä¸‡å††ï¼ˆ82%ï¼‰',expense:'1,422ä¸‡å††ï¼ˆ79%ï¼‰',balance:'+50ä¸‡å††',balColor:'var(--yellow)',timeline:[{date:'2/25',icon:'ğŸ”»',name:'â–¡â–¡è¨­å‚™',amt:'-80ä¸‡',cls:'exp'},{date:'3/10',icon:'ğŸ”º',name:'å…ƒè«‹å…¥é‡‘',amt:'+200ä¸‡',cls:'inc'},{date:'3/25',icon:'ğŸ”»',name:'ä»•ä¸Šã’',amt:'-100ä¸‡',cls:'exp'}]},
  D:{name:'Dç¾å ´ï¼ˆâ—‡â—‡å€‰åº«ï¼‰',status:'r',statusText:'å±é™º',contract:'2,400ä¸‡å††',income:'1,728ä¸‡å††ï¼ˆ72%ï¼‰',expense:'1,752ä¸‡å††ï¼ˆ73%ï¼‰',balance:'-30ä¸‡å††',balColor:'var(--red)',timeline:[{date:'2/28',icon:'ğŸ”»',name:'è¿½åŠ å·¥äº‹',amt:'-50ä¸‡',cls:'exp'},{date:'3/15',icon:'ğŸ”º',name:'å…ƒè«‹å…¥é‡‘',amt:'+300ä¸‡',cls:'inc'},{date:'3/20',icon:'ğŸ”»',name:'å¤–æ³¨è²»',amt:'-120ä¸‡',cls:'exp'}]}
};
const sels={};

function nav(s){
  document.querySelectorAll('.screen').forEach(e=>e.classList.remove('active'));
  const el=document.getElementById('s-'+s);
  if(el){el.classList.add('active');el.querySelector('.content')?.classList.add('fade-in')}
  document.querySelectorAll('.bnav a').forEach(a=>a.classList.remove('on'));
  const m={dashboard:0,approval:1,input:2,report:3,settings:4};
  if(m[s]!==undefined)document.querySelectorAll('.bnav a')[m[s]].classList.add('on');
  window.scrollTo(0,0);
}

function cycleRole(){
  roleIdx=(roleIdx+1)%roles.length;applyRole();
  showToast('ğŸ‘¤ '+roles[roleIdx].label);
}
function applyRole(){
  const r=roles[roleIdx];
  document.getElementById('role-label').textContent=r.label;
  document.getElementById('settings-role').textContent=r.label;
  if(r.id==='foreman'){
    document.getElementById('nav-approval').style.display='none';
    document.getElementById('badge-count').parentElement.style.display='none';
    document.getElementById('bal-label').textContent='Aç¾å ´ã®æ®‹é«˜';
    document.getElementById('bal-num').innerHTML='450<small>ä¸‡å††</small>';
    document.getElementById('alert-section').style.display='none';
    document.getElementById('alerts-wrap').style.display='none';
    document.getElementById('chart-area').style.display='none';
    document.getElementById('signals-area').innerHTML='<div class="sig on"><div class="sig-label">ä»Šæœˆ</div><div class="sig-icon">ğŸŸ¢</div><div class="sig-val g">+120ä¸‡</div></div><div class="sig"><div class="sig-label">æ¥æœˆ</div><div class="sig-icon">ğŸŸ¢</div><div class="sig-val g">+80ä¸‡</div></div><div class="sig"><div class="sig-label">å†æ¥æœˆ</div><div class="sig-icon">ğŸŸ¡</div><div class="sig-val y">+15ä¸‡</div></div>';
    document.getElementById('proj-section').textContent='ğŸ“‹ æ‹…å½“ç¾å ´';
    document.querySelectorAll('.proj').forEach((p,i)=>p.style.display=i===0?'':'none');
  }else{
    document.getElementById('nav-approval').style.display='';
    document.getElementById('badge-count').parentElement.style.display='';
    document.getElementById('bal-label').textContent='ä¼šç¤¾ã®ç¾åœ¨æ®‹é«˜';
    document.getElementById('bal-num').innerHTML='1,520<small>ä¸‡å††</small>';
    document.getElementById('alert-section').style.display='';
    document.getElementById('alerts-wrap').style.display='';
    document.getElementById('chart-area').style.display='';
    document.getElementById('signals-area').innerHTML='<div class="sig on" onclick="sigSel(this)"><div class="sig-label">ä»Šæœˆ</div><div class="sig-icon">ğŸŸ¢</div><div class="sig-val g">+320ä¸‡</div></div><div class="sig" onclick="sigSel(this)"><div class="sig-label">æ¥æœˆ</div><div class="sig-icon">ğŸŸ¡</div><div class="sig-val y">+45ä¸‡</div></div><div class="sig" onclick="sigSel(this)"><div class="sig-label">å†æ¥æœˆ</div><div class="sig-icon">ğŸ”´</div><div class="sig-val r">-180ä¸‡</div></div>';
    document.getElementById('proj-section').textContent='ğŸ“‹ ç¾å ´ä¸€è¦§';
    document.querySelectorAll('.proj').forEach(p=>p.style.display='');
  }
}
function sigSel(el){el.parentElement.querySelectorAll('.sig').forEach(s=>s.classList.remove('on'));el.classList.add('on')}
function openDetail(id){
  const p=projects[id];
  document.getElementById('m-title').textContent=p.name;
  document.getElementById('m-dot').className='ds '+p.status;
  document.getElementById('m-status').textContent=p.statusText;
  document.getElementById('m-status').style.color=p.balColor;
  document.getElementById('m-contract').textContent=p.contract;
  document.getElementById('m-income').textContent=p.income;
  document.getElementById('m-expense').textContent=p.expense;
  document.getElementById('m-balance').textContent=p.balance;
  document.getElementById('m-balance').style.color=p.balColor;
  document.getElementById('m-timeline').innerHTML=p.timeline.map(t=>`<div class="tl-item"><div class="tl-date">${t.date}</div><div class="tl-icon">${t.icon}</div><div class="tl-name">${t.name}</div><div class="tl-amt ${t.cls}">${t.amt}</div></div>`).join('');
  document.getElementById('detail-overlay').classList.add('show');
}
function closeDetail(e){document.getElementById('detail-overlay').classList.remove('show')}
function doApprove(id){
  const c=document.getElementById(id);c.style.transition='all .3s';c.style.opacity='.4';
  setTimeout(()=>{c.innerHTML='<div style="text-align:center;padding:18px;font-weight:700;color:var(--green);font-size:14px">âœ“ æ‰¿èªã—ã¾ã—ãŸ</div>';c.style.opacity='1';showToast('âœ“ æ‰¿èªå®Œäº†')},400);
}
function switchReport(tab,id){
  tab.parentElement.querySelectorAll('.rtab').forEach(t=>t.classList.remove('on'));tab.classList.add('on');
  document.querySelectorAll('.report-panel').forEach(p=>p.style.display='none');document.getElementById(id).style.display='';
}
function sel(btn,grp){
  btn.parentElement.querySelectorAll('.sel-btn').forEach(b=>b.classList.remove('on'));btn.classList.add('on');sels[grp]=1;checkForm();
}
function setAmt(btn,v){
  document.getElementById('pay-amount').value=v;
  btn.parentElement.querySelectorAll('.qa').forEach(q=>q.classList.remove('on'));btn.classList.add('on');checkForm();
}
function checkForm(){
  const ok=document.getElementById('pay-amount')?.value>0&&sels.site&&sels.vendor&&sels.cat;
  document.getElementById('submit-pay').disabled=!ok;
  if(sels.site&&document.getElementById('pay-amount')?.value>0){
    const a=parseInt(document.getElementById('pay-amount').value)||0;
    document.getElementById('impact-preview').style.display='';
    const sr=450-a;const tr=1520-a;
    document.getElementById('impact-site').textContent=sr+'ä¸‡ '+(sr>100?'ğŸŸ¢':sr>0?'ğŸŸ¡':'ğŸ”´');
    document.getElementById('impact-total').textContent=tr+'ä¸‡ '+(tr>500?'ğŸŸ¢':'ğŸŸ¡');
  }else{document.getElementById('impact-preview').style.display='none'}
}
function switchInput(tab,id){
  tab.parentElement.querySelectorAll('.itt').forEach(t=>t.classList.remove('on'));tab.classList.add('on');
  document.querySelectorAll('.input-panel').forEach(p=>p.style.display='none');document.getElementById(id).style.display='';
}
function submitPay(){
  const o=document.getElementById('success-overlay');
  document.getElementById('success-text').textContent='ç”³è«‹ã—ã¾ã—ãŸ';
  document.getElementById('success-sub').textContent='æ‰¿èªè€…ã«é€šçŸ¥ãŒé€ä¿¡ã•ã‚Œã¾ã—ãŸ';
  o.classList.add('show');
  setTimeout(()=>{o.classList.remove('show');nav('dashboard');
    document.querySelectorAll('#input-pay .sel-btn').forEach(b=>b.classList.remove('on'));
    document.querySelectorAll('.qa').forEach(q=>q.classList.remove('on'));
    document.getElementById('pay-amount').value='';
    document.getElementById('impact-preview').style.display='none';
    document.getElementById('submit-pay').disabled=true;
    Object.keys(sels).forEach(k=>delete sels[k]);
  },1800);
}
function submitInc(){
  const o=document.getElementById('success-overlay');
  document.getElementById('success-text').textContent='å…¥é‡‘ã‚’ç™»éŒ²ã—ã¾ã—ãŸ';
  document.getElementById('success-sub').textContent='æ®‹é«˜ãƒ»äºˆæ¸¬ã«åæ˜ ã•ã‚Œã¾ã—ãŸ';
  o.classList.add('show');setTimeout(()=>{o.classList.remove('show');nav('dashboard')},1800);
}
function showToast(msg){const t=document.getElementById('toast');t.textContent=msg;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),2000)}
</script>
</body>
</html>
